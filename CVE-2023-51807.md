# CCVE-2023-51807

Product: https://gitee.com/oufu/ofcms

OFCMS 1.14 has stored xss injection
1. trigger point: Content management -> Article Management -> Title add or modify
Inject payload: "onmouseover=alert(1)" (can be replaced with automatically triggered payload)

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/57f3a95d-fecf-4852-b752-9bfaa66c9d84)

2. The update interface is requested
![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/f592dabd-337d-4762-a32e-1c2d5a8e0709)

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/c45ae031-93dc-4bda-9ca1-f7cdf1e4f0d2)

3. You can see that the back-end does not do any verification on the parameters, and directly saves them to the database

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/f7cf0906-cd63-44be-8234-c239ad571b82)

4. When the page is refreshed, the query interface is called to take out the value in the database

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/f8d269a1-b12e-4f98-ad09-0f823f23be61)

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/39c31490-da15-4344-9195-7fdc56becc3f)

5. You can see that payload is injected into the template. Closing the payload with double quotation marks causes the attribute to escape

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/c039fda9-79ba-40a3-8863-e1ed01710bed)

6. the current page can be triggered

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/d7f3125f-c6c8-41ee-94c2-a6008d8d18cd)

7. the same home page can also be triggered

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/9bbc3d47-25fa-45ce-9e8c-27bda097849e)

![image](https://github.com/Phantom4me/CVE-Management/assets/152193131/8d29a440-ef1b-4a86-8d64-cfc2ee92d980)
